<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.unity.game.mapper.OutingMapper">

    <select id="getClothingList" resultType="map">
        SELECT tr.RECIPE_ID,
               ti.ITEM_ID    as r_itemid,
               ti.NAME       as r_name,
               ti.`DESC`     as r_desc,
               tr.REQ_ITEM   AS req_itemid,
               ti1.NAME      AS req_name,
               tr.R_ITEM_CNT as req_itemcnt
        FROM TBL_UNITY_ITEM ti
                 INNER JOIN TBL_UNITY_RECIPE tr
                            ON ti.ITEM_ID = tr.ITEM_ID
                 LEFT JOIN TBL_UNITY_ITEM ti1
                           ON tr.REQ_ITEM = ti1.ITEM_ID
        WHERE ti.TYPE_ID = 1002
        ORDER BY ti.ITEM_ID
    </select>

    <select id="getClothingBuyList" resultType="map">
        SELECT ti.ITEM_ID as itemid, ti.NAME as itemnm, ti.`DESC` as itemdesc, ti.SELL_PRI, ti.BUY_PRI as buyprice
        FROM TBL_UNITY_ITEM ti
        WHERE ti.TYPE_ID = 3003
    </select>

    <select id="getSmithyList" resultType="map">
        SELECT tr.RECIPE_ID AS recipe_id,
               ti.ITEM_ID AS itemid,
               ti.NAME AS itemnm,
               ti.`DESC` AS itemdesc,
               tr.REQ_ITEM AS req_item,
               ti1.NAME AS req_name,
               tr.R_ITEM_CNT As req_itemcnt
          FROM TBL_UNITY_ITEM ti
         INNER JOIN TBL_UNITY_RECIPE tr
            ON ti.ITEM_ID = tr.ITEM_ID
          LEFT JOIN TBL_UNITY_ITEM ti1
            ON tr.REQ_ITEM = ti1.ITEM_ID
        WHERE ti.TYPE_ID = 1000
           OR ti.TYPE_ID = 1001
        ORDER BY ti.ITEM_ID
    </select>

    <select id="getSmithyBuyList" resultType="map">
        SELECT ti.ITEM_ID AS itemid,
               ti.NAME AS itemnm,
               ti.`DESC` AS itemdesc,
               ti.SELL_PRI AS sellprice,
               ti.BUY_PRI AS buyprice
        FROM TBL_UNITY_ITEM ti
        WHERE ti.TYPE_ID = 3000
           OR  ti.TYPE_ID = 3001
           OR  ti.TYPE_ID = 3002
    </select>

    <select id="gethospitalBuyList" resultType="map">
        SELECT ti.ITEM_ID AS itemid,
               ti.NAME AS itemnm,
               ti.`DESC` AS itemdesc,
               ti.SELL_PRI AS sellprice,
               ti.BUY_PRI AS buyprice
          FROM TBL_UNITY_ITEM ti
         WHERE TYPE_ID =3004
            or TYPE_ID= 2002
    </select>

    <select id="getvarietyStoreList" resultType="map">
        SELECT ti.ITEM_ID AS itemid,
               ti.TYPE_ID AS typeid,
               ti.NAME AS itemnm,
               ti.`DESC` AS itemdesc,
               ti.SELL_PRI AS sellprice,
               ti.BUY_PRI AS buyprice
          FROM TBL_UNITY_ITEM ti
         WHERE TYPE_ID =2001
            or TYPE_ID= 3005
    </select>

    <select id="getrestaurantList" resultType="map">
        SELECT ti.ITEM_ID AS itemid,
               ti.TYPE_ID AS typeid,
               ti.NAME AS itemnm,
               ti.`DESC` AS itemdesc,
               ti.SELL_PRI AS sellprice,
               ti.BUY_PRI AS buyprice
          FROM TBL_UNITY_ITEM ti
         WHERE TYPE_ID = 2000
    </select>

    <select id="getquestList" resultType="map">
        SELECT gq.QNO AS questno,
               gq.QNM AS questnm,
               gq.QMEMO AS questmemo,
               gq.Q_OBJ AS qitemid ,
               ti.NAME as qitemnm,
               gq.Q_OCNT AS qitemcnt,
               gq.Q_REWARD AS ritemid,
               ti2.NAME as ritemnm,
               gq.Q_REWARD_CNT AS ritemcnt,
               gq.SFALG AS submit,
               gq.CFLAG AS complete
          FROM TBL_UNITY_QUEST gq
         INNER JOIN TBL_UNITY_ITEM ti
            ON ti.ITEM_ID = gq.Q_OBJ
         INNER JOIN TBL_UNITY_ITEM ti2
            ON ti2.ITEM_ID = gq.Q_REWARD
    </select>
    <update id="updatequestFlag" parameterType="map">
        UPDATE TBL_UNITY_QUEST
           SET CFLAG = #{cflag},
               SFALG = #{sflag}
         WHERE QNO =  #{questno}
    </update>
    <update id="setafterHeal" parameterType="map">
        update TBL_UNITY_USERINFO
           set CASH = #{payment},
               CHP = #{maxhp}
         where PID = #{pid}
    </update>
</mapper>